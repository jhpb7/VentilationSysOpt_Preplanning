from pyomo2h5 import save_yaml


def main():
    data = {
        "V": {
            None: [
                "0~01",
                "0~02",
                "0~1",
                "0~2",
                "0~3",
                "0~4",
                "1~1",
                "1~2",
                "1~3",
                "1-1~1",
                "1-1~2",
                "1-1~3",
                "1-1~4",
                "1-2~1",
                "1-2~2",
                "1-2~3",
                "1-2-1~1",
                "1-2-1~2",
                "1-2-1~3",
                "1-2-1~4",
                "1-2-1~5",
                "1-2-2~1",
                "1-2-2~2",
                "1-2-2~3",
                "1-2-2-1~1",
                "1-2-2-1~2",
                "1-2-2-1~3",
                "1-2-2-1~4",
                "1-2-2-1~5",
                "1-2-2-2~1",
                "1-2-2-2~2",
                "1-2-2-2~3",
                "1-2-2-2~4",
                "1-2-2-2~5",
                "2~1",
                "2~2",
                "2~3",
                "2-1~1",
                "2-1~2",
                "2-1~3",
                "2-1~4",
                "2-1~5",
                "2-2~1",
                "2-2~2",
                "2-2~3",
                "2-2-1~1",
                "2-2-1~2",
                "2-2-1~3",
                "2-2-1~4",
                "2-2-1~5",
                "2-2-2~1",
                "2-2-2~2",
                "2-2-2~3",
                "2-2-2~4",
                "2-2-2~5",
            ]
        },
        "V_ports": {
            None: [
                "0~01",
                "1-1~4",
                "1-2-1~5",
                "1-2-2-1~5",
                "1-2-2-2~5",
                "2-1~5",
                "2-2-1~5",
                "2-2-2~5",
            ]
        },
        "E": {
            None: [
                ("0~01", "0~02"),
                ("0~02", "0~1"),
                ("0~1", "0~2"),
                ("0~2", "0~3"),
                ("0~3", "0~4"),
                ("0~4", "1~1"),
                ("1~1", "1~2"),
                ("1~2", "1~3"),
                ("1~3", "1-1~1"),
                ("1-1~1", "1-1~2"),
                ("1-1~2", "1-1~3"),
                ("1-1~3", "1-1~4"),
                ("1~3", "1-2~1"),
                ("1-2~1", "1-2~2"),
                ("1-2~2", "1-2~3"),
                ("1-2~3", "1-2-1~1"),
                ("1-2-1~1", "1-2-1~2"),
                ("1-2-1~2", "1-2-1~3"),
                ("1-2-1~3", "1-2-1~4"),
                ("1-2-1~4", "1-2-1~5"),
                ("1-2~3", "1-2-2~1"),
                ("1-2-2~1", "1-2-2~2"),
                ("1-2-2~2", "1-2-2~3"),
                ("1-2-2~3", "1-2-2-1~1"),
                ("1-2-2-1~1", "1-2-2-1~2"),
                ("1-2-2-1~2", "1-2-2-1~3"),
                ("1-2-2-1~3", "1-2-2-1~4"),
                ("1-2-2-1~4", "1-2-2-1~5"),
                ("1-2-2~3", "1-2-2-2~1"),
                ("1-2-2-2~1", "1-2-2-2~2"),
                ("1-2-2-2~2", "1-2-2-2~3"),
                ("1-2-2-2~3", "1-2-2-2~4"),
                ("1-2-2-2~4", "1-2-2-2~5"),
                ("0~4", "2~1"),
                ("2~1", "2~2"),
                ("2~2", "2~3"),
                ("2~3", "2-1~1"),
                ("2-1~1", "2-1~2"),
                ("2-1~2", "2-1~3"),
                ("2-1~3", "2-1~4"),
                ("2-1~4", "2-1~5"),
                ("2~3", "2-2~1"),
                ("2-2~1", "2-2~2"),
                ("2-2~2", "2-2~3"),
                ("2-2~3", "2-2-1~1"),
                ("2-2-1~1", "2-2-1~2"),
                ("2-2-1~2", "2-2-1~3"),
                ("2-2-1~3", "2-2-1~4"),
                ("2-2-1~4", "2-2-1~5"),
                ("2-2~3", "2-2-2~1"),
                ("2-2-2~1", "2-2-2~2"),
                ("2-2-2~2", "2-2-2~3"),
                ("2-2-2~3", "2-2-2~4"),
                ("2-2-2~4", "2-2-2~5"),
            ]
        },
        "E_duct": {
            None: [
                ("0~3", "0~4"),
                ("0~4", "1~1"),
                ("0~4", "2~1"),
                ("1~2", "1~3"),
                ("1~3", "1-1~1"),
                ("1~3", "1-2~1"),
                ("1-2~2", "1-2~3"),
                ("1-2~3", "1-2-1~1"),
                ("1-2~3", "1-2-2~1"),
                ("1-2-1~3", "1-2-1~4"),
                ("1-2-2~2", "1-2-2~3"),
                ("1-2-2~3", "1-2-2-1~1"),
                ("1-2-2~3", "1-2-2-2~1"),
                ("1-2-2-1~3", "1-2-2-1~4"),
                ("1-2-2-2~3", "1-2-2-2~4"),
                ("2~2", "2~3"),
                ("2~3", "2-1~1"),
                ("2~3", "2-2~1"),
                ("2-1~3", "2-1~4"),
                ("2-2~2", "2-2~3"),
                ("2-2~3", "2-2-1~1"),
                ("2-2~3", "2-2-2~1"),
                ("2-2-1~3", "2-2-1~4"),
                ("2-2-2~3", "2-2-2~4"),
            ]
        },
        "E_duct_vertical": {
            None: [("1-2~2", "1-2~3"), ("1-2-2~2", "1-2-2~3"), ("2-2~2", "2-2~3")]
        },
        "E_fan_station": {
            None: [
                ("0~1", "0~2"),
                ("1~1", "1~2"),
                ("1-1~2", "1-1~3"),
                ("1-2~1", "1-2~2"),
                ("1-2-1~2", "1-2-1~3"),
                ("1-2-2~1", "1-2-2~2"),
                ("1-2-2-1~2", "1-2-2-1~3"),
                ("1-2-2-2~2", "1-2-2-2~3"),
                ("2~1", "2~2"),
                ("2-1~2", "2-1~3"),
                ("2-2~1", "2-2~2"),
                ("2-2-1~2", "2-2-1~3"),
                ("2-2-2~2", "2-2-2~3"),
            ]
        },  #
        "E_fan_station_multi": {
            None: [
                ("0~1", "0~2"),
                ("1~1", "1~2"),
                ("1-1~2", "1-1~3"),
                ("1-2~1", "1-2~2"),
                ("1-2-1~2", "1-2-1~3"),
                ("1-2-2~1", "1-2-2~2"),
                ("1-2-2-1~2", "1-2-2-1~3"),
                ("1-2-2-2~2", "1-2-2-2~3"),
                ("2~1", "2~2"),
                ("2-1~2", "2-1~3"),
                ("2-2~1", "2-2~2"),
                ("2-2-1~2", "2-2-1~3"),
                ("2-2-2~2", "2-2-2~3"),
            ]
        },
        "E_vfc": {
            None: [
                ("1-1~1", "1-1~2"),
                ("1-2-1~1", "1-2-1~2"),
                ("1-2-2-1~1", "1-2-2-1~2"),
                ("1-2-2-2~1", "1-2-2-2~2"),
                ("2-1~1", "2-1~2"),
                ("2-2-1~1", "2-2-1~2"),
                ("2-2-2~1", "2-2-2~2"),
            ]
        },
        "E_fixed": {
            None: [
                ("0~2", "0~3"),
                ("1-1~3", "1-1~4"),
                ("1-2-1~4", "1-2-1~5"),
                ("1-2-2-1~4", "1-2-2-1~5"),
                ("1-2-2-2~4", "1-2-2-2~5"),
                ("2-1~4", "2-1~5"),
                ("2-2-1~4", "2-2-1~5"),
                ("2-2-2~4", "2-2-2~5"),
            ]
        },
        "rho": {None: 1.2},
        "max_pressure": {None: 6000},
        # following zeta values are dp = zeta * q^2 and not related to the velocity!
        "fixed_zeta": {
            ("0~2", "0~3"): 55,
            ("1-1~3", "1-1~4"): 260.330578512397,
            ("1-2-1~4", "1-2-1~5"): 800,
            ("1-2-2-1~4", "1-2-2-1~5"): 800,
            ("1-2-2-2~4", "1-2-2-2~5"): 1260,
            ("2-1~4", "2-1~5"): 260.330578512397,
            ("2-2-1~4", "2-2-1~5"): 3500,
            ("2-2-2~4", "2-2-2~5"): 1260,
        },
        "electric_energy_costs": {None: 0.2538 / 1000},  # in â‚¬/Wh
        "vfc_costs": {None: 1000},
        "operating_years": {None: 12},
        "operating_days_per_year": {None: 250},
        "operating_hours_per_day": {None: 14},
        "price_change_factor_electricity": {None: 1.052},
        "price_change_factor_service_maintenance": {None: 1.03},
        "interest_rate": {None: 1.07},
    }

    # %% duct sizing

    duct_sizing_data = {
        "duct_width_min": {(i, j): 0.2 for (i, j) in data["E_duct"][None]},
        "duct_width_max": {(i, j): 1 for (i, j) in data["E_duct"][None]},
        "duct_height_min": {(i, j): 0.2 for (i, j) in data["E_duct"][None]},
        "duct_height_max": {(i, j): 1 for (i, j) in data["E_duct"][None]},
        "duct_length": {
            ("0~3", "0~4"): 3,
            ("0~4", "1~1"): 25,
            ("0~4", "2~1"): 42,
            ("1~2", "1~3"): 3,
            ("1~3", "1-1~1"): 20,
            ("1~3", "1-2~1"): 1,
            ("1-2~2", "1-2~3"): 1,
            ("1-2~3", "1-2-1~1"): 14,
            ("1-2~3", "1-2-2~1"): 3,
            ("1-2-1~3", "1-2-1~4"): 10,
            ("1-2-2~2", "1-2-2~3"): 3,
            ("1-2-2~3", "1-2-2-1~1"): 14,
            ("1-2-2~3", "1-2-2-2~1"): 2,
            ("1-2-2-1~3", "1-2-2-1~4"): 4,
            ("1-2-2-2~3", "1-2-2-2~4"): 22,
            ("2~2", "2~3"): 2,
            ("2~3", "2-1~1"): 3,
            ("2~3", "2-2~1"): 4,
            ("2-1~3", "2-1~4"): 6,
            ("2-2~2", "2-2~3"): 1,
            ("2-2~3", "2-2-1~1"): 20,
            ("2-2~3", "2-2-2~1"): 2,
            ("2-2-1~3", "2-2-1~4"): 1,
            ("2-2-2~3", "2-2-2~4"): 20,
        },
    }

    duct_sizing_data["duct_height_max"][("0~3", "0~4")] = 1.5
    duct_sizing_data["duct_width_max"][("0~3", "0~4")] = 1.5

    duct_data = {
        # "lambda_duct": {None: 0.02},
        "n_duct_bendings": {
            ("0~3", "0~4"): 1,
            ("0~4", "1~1"): 1,
            ("0~4", "2~1"): 9,
            ("1~3", "1-1~1"): 1,
            ("1-2~3", "1-2-1~1"): 2,
            ("1-2-2~3", "1-2-2-1~1"): 2,
            ("1-2-2-2~3", "1-2-2-2~4"): 2,
            ("2~3", "2-1~1"): 2,
            ("2-2~3", "2-2-1~1"): 3,
            ("2-2~3", "2-2-2~1"): 1,
            ("2-2-2~3", "2-2-2~4"): 2,
        },
        "duct_e_branch": {
            None: [
                ("1~3", "1-1~1", "1-2~1"),
                ("1-2~3", "1-2-2~1", "1-2-1~1"),
                ("1-2-2~3", "1-2-2-1~1", "1-2-2-2~1"),
                ("2~3", "2-1~1", "2-2~1"),
                ("2-2~3", "2-2-2~1", "2-2-1~1"),
            ]
        },
        "duct_t_branch_node": {
            None: [
                "0~4",
            ]
        },
        "duct_area_costs": {None: 50},
        "duct_resistance_coefficient": {None: 0.02},
    }

    duct_data.update(duct_sizing_data)

    data.update(duct_data)

    save_yaml("data/network_data/GPZ.yml", data)


if __name__ == "__main__":
    main()
